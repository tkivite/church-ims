//$("#basicExample, .time-input").timepicker({'timeFormat': "H:i:s"});/*$(".datefilter").datepicker({dateFormat: "yy-mm-dd"});$(".datefilternow").datepicker({dateFormat: "yy-mm-dd",minDate: '0'});$(".datefilterpast").datepicker({dateFormat: "yy-mm-dd",minDate: '-1'});$(".datefilterfuture").datepicker({dateFormat: "yy-mm-dd",maxDate: '-1'});//$(".datefilter2").datepicker({dateFormat: "H:i:s"});$(".datefilter2").timepicker({timeFormat: 'HH'});$(function() {    computeAmount();});$(function() {    $('.paymentsItems').lightBox({	imageLoading: 'skins/tbcare/images/loading6.gif',	imageBtnClose: 'skins/tbcare/images/close.gif',	imageBtnPrev: 'skins/tbcare/images/previous.png',	imageBtnNext: 'skins/tbcare/images/next.png',                fixedNavigation: false    });});*/$("[name='action_effected']").change(function() {	$.getJSON("inc/setvalue.php",{penalty: $("[name='action_effected']").val(), ajax: 'true'}, function(j){      var options = '';	       for (var i = 0; i < j.length; i++) {        options += '<option value="' + j[i].optionValue + '">' + j[i].optionDisplay + '</option>';      }      $("select#penalty_type").html(options);		});});$("#businessregion").change(function() {$("#businesslocation").children('option').remove();	$.getJSON("inc/setvalue.php",{region: $("#businessregion").val(), ajax: 'true'}, function(j){      var options = '';	       for (var i = 0; i < j.length; i++) {        options += '<option value="' + j[i].optionValue + '">' + j[i].optionDisplay + '</option>';      }      $("select#businesslocation").html(options);    });	});$("#county").change(function() {$("#constituency").children('option').remove();	$.getJSON("inc/setvalue.php",{county: $("#county").val(), ajax: 'true'}, function(j){      var options = '';	       for (var i = 0; i < j.length; i++) {        options += '<option value="' + j[i].optionValue + '">' + j[i].optionDisplay + '</option>';      }      $("select#constituency").html(options);    });	});$(".reduceable").keyup(function(){    var itemName = $(this).attr("name").split("_");    $("#Notes_"+itemName[1]).fadeIn(700);    computeAmount(); });$("[name^='approvalOne_']").change(function(){    var itemName = $(this).attr("name").split("_");    if($("[name='approvalOne_"+itemName[1]+"']:checked").val()=='Rejected')        $("#Notes_"+itemName[1]).fadeIn(700);    computeAmount();});$(document).ready(function(){         $(".approvalnotesdisabled").each(function(i, obj) {                       if($(this).val()=='')            {              $(this).closest("span").hide();            }           });      //  $("[id^='Notes_']").closest("span").hide();});$("[name='provinces'],[name='ordertypes'],[name='budgets']").change(function(){    var payments = 0;    $.ajax({        url: "inc/setvalue.php?region="+ $("[name='provinces']").val() + "&ordertype=" + $("[name='ordertypes']").val() + "&budget=" + $("[name='budgets']").val(),        success: function(result)        {            payments = result;        },        complete: function() {            $("[name='payments']").val(payments);            if($("[name='payments']").val()>0)                {                    $("[name='action']").fadeIn();                }            else                {                    $("[name='action']").fadeOut();                }                }        });    });function computeAmount(){    var total=0;    $("[name='approval'] .reduceable").each(function(i, obj) {       var itemName = $(this).attr("name").split("_");       if($("[name='approvalOne_"+itemName[1]+"']:checked").val()!='Rejected')           total += parseFloat($(this).val());    });    $("[name='approvalOneAmount']").val(total);    }function addEvent(){   // $('#gridtable').hide();   // $('#loadingAdd').show();   // $('.addButton').hide();   // $('#addElements').fadeOut();   // $('#filterGrid').fadeOut();   $('#dataTable_wrapper').fadeOut();               // $('#loadingAdd').show();                $('.addButton').fadeOut();                $('#addElements').fadeOut();    $.ajax({        type: 'get',        url: '../../SuperFrame/Shared/app/resolve.php',        data: 'sid=' + $('#sub_page').val() + '&id=' + $('#page_id').val() + '&cell=' + $(".gridCell").attr("title"),        success: function(result) {            $('#gridform').show();            $('#gridform').html(result);                     },        complete: function() {          //  $('#loadingAdd').hide();        }    });    return false;}$(".gridResetPinButton").click(function() {    var cell = $(this).closest('tr').attr('title'); //The Primary key for the row    var page = $('#nextpage').val(); 				//The Id representing the inner page    $('#ajaxcontent' + cell).hide();    $('#loading' + cell).show();    var form = $(this).closest("form");    var formname = form.attr("name");         var msg = "Are you sure you want to reset Beneficiary's PIN?";         if(formname=="user"){        msg = "Are you sure you want to "+$(this).val()+"?";    }        var resetItem = confirm(msg);    if (resetItem)    {                $.blockUI({css: {                border: 'none',                padding: '15px',                backgroundColor: '#000',                '-webkit-border-radius': '10px',                '-moz-border-radius': '10px',                opacity: .5,                color: '#fff'            }});        $.ajax({            type: 'post',            url: 'forms/process_form.php?f=' + formname + '&action=resetpin',            data: $("[name='" + formname + "']").serialize(),            success: function(result) {                //alert(result);            },            complete: function() {                location.reload();            }        });    }    return false;});$(".gridPrimaryButton").click(function() {    var cell = $(this).closest('tr').attr('title'); //The Primary key for the row    var page = $('#nextpage').val(); 				//The Id representing the inner page    $('#ajaxcontent' + cell).hide();    $('#loading' + cell).show();    $.ajax({        type: 'get',        url: 'Shared/app/resolve.php',        data: 'key=' + cell + '&sid=' + page + '&id=' + $('#page_id').val(),        success: function(result) {            $('#ajaxcontent' + cell).show();            $('#ajaxcontent' + cell).empty();            $('#ajaxcontent' + cell).html(result);                   },        complete: function() {            $('#loading' + cell).hide();        }    });});$("#dismiss").click(function() {    location.reload();});$(".gridSecButton").click(function() {    $(this).closest('tr').slideUp();});$(".gridSecondaryButton").click(function() {    $('#gridform').fadeOut();    $('#gridform').empty();    $('#gridtable').fadeIn();    $('#addElements').fadeIn();    $('.addButton').fadeIn();    $('#filterGrid').fadeIn();     });$(".gridProcessButton").click(function() {    var cell = $(this).closest('tr').attr('title'); //The Primary key for the row    var page = $('').val(); 				//The Id representing the inner page    //$('#ajaxcontent'+cell).hide();	    $('#loading' + cell).show();    $.ajax({        type: 'get',        url: 'Shared/app/resolve.php',        data: 'sid=' + $('#sub_page').val() + '&id=' + $('#page_id').val() + '&cell=' + $(".gridCell").attr("title"),        success: function(result) {            $('#ajaxcontent' + cell).show();            $('#ajaxcontent' + cell).empty();            $('#ajaxcontent' + cell).html(result);        },        complete: function() {            $('#loading' + cell).hide();        }    });});$(".gridEditButton").click(function() {    addEvent();});$("#action,[name='action'],[name='settlecomm']").click(function(e) {        var form = $(this).closest("form");    var formName = form.attr("name");    var ret = true;    var allVals = [];    // alert(formName);    if (formName == 'beneficiary' || formName == 'service_provider')    {        if ($('[name="programs[]"]:checked').length == 0)  {            alert("You have to select at least one program");            return false;        }    }    if (formName == 'user' || formName == 'role')    {        $('[name="permission[]"]:checked').each(function() {            allVals.push($(this).attr("value"));        });    }    if(formName == 'settlecommission')    {        $('[name="primarykey[]"]:checked').each(function() {            allVals.push($(this).attr("value"));        });    }    $('[name="' + formName + '"] .required').each(function(i, obj) {		if($(this).is(":visible"))		{        if ($(this).val() == "")        {            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Please complete");            ret = false;            return false;        }		else if ($(this).hasClass("email") &&  !($(this).val().match(/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/)))		{			$(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Please provide a valid email address");            ret = false;            return false;		}        else if ($(this).hasClass("decimal") && !$.isNumeric($(this).val()))        {            $(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Please provide a decimal number");            ret = false;            return false;        }        else if($(this).hasClass("positive") && $(this).val()<0)        {            $(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Please provide a positive value");            ret = false;            return false;        }        /*else if($(this).hasClass("sufficient"))//validate_amount();        {            validate_amount();            alert($("#amount_check_result").text()+" Text>>");            if($("#amount_check_result").text()!=""){                $(this).attr("value", "");                $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");                $(this).attr("placeholder", "Please provide a positive value");                ret = false;                return false;            } else {                ret = true;                return true;            }        }*/	else if ($(this).hasClass("msisdn")  && !($(this).val().match(/^(2547)/) && $(this).val().length==12 && $.isNumeric($(this).val())))        {            $(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Please enter phone number in the format 25472XXXXXXXX");            ret = false;            return false;        }		else if ($(this).hasClass("password")  && !($(this).val().length>=6 && $(this).val().length<=32))        {            $(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Password must be at least 6 characters and no more than 32 characters long");            ret = false;            return false;        }		else if ($(this).hasClass("shortcode")  && !($(this).val().length>=5 && $(this).val().length<=20))        {            $(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Shortcode must be at least 5 characters and no more than 20 characters long");            ret = false;            return false;        } else if ($(this).hasClass("datefilterfuture") && (!/^\d{4}-\d{2}-\d{2}$/.test($(this).val())))        {            $(this).attr("value", "");            $(this).attr("style", "border: 1px inset rgb(251, 58, 58);");            $(this).attr("placeholder", "Invalid date format. Correct format: YYYY-MM-DD");            ret = false;            return false;        } 		        else        {            $(this).attr("style", "border: 1px inset rgb(89, 189, 69);");            $(this).attr("placeholder", "Please complete");            ret = true;        }    }	});    if(formName == 'payment_request' && ret)    {        var ret = confirm("Are you sure you want to submit this request?");    }    if (ret == false) //Hault script execution if check above returns false        return ret;    var form = $(this).closest("form");    var formname = form.attr("name");    $.blockUI({ css: {            border: 'none',            padding: '15px',            backgroundColor: '#000',            '-webkit-border-radius': '10px',            '-moz-border-radius': '10px',            opacity: .5,            color: '#fff'        } });         if(                        formName != 'donor_upload'             &&  formName != 'program_upload'             &&  formName != 'beneficiary_upload'             &&  formName != 'sp_upload'             &&  formName != 'organisation_upload'             &&  formName != 'payment_request' 			&&  formName != 'disbursement_upload'            &&  formName != 'beneficiaryallocation_upload'			&&  formName != 'user_upload'        )        {                         $.ajax({                    type: 'post',                    url: 'forms/process_form.php?f=' + formname,                    data: $("[name='" + formname + "']").serialize() + "&permission=" + allVals,                    success: function(result) {                       // alert(result);                      //console.log(result);                    },                    complete: function() {                        location.reload();                    }                });                return false;        }    else        {          /*  $.blockUI({ css: {             border: 'none',             padding: '15px',             backgroundColor: '#000',             '-webkit-border-radius': '10px',             '-moz-border-radius': '10px',             opacity: .5,             color: '#fff'         } }); */        //setTimeout($.unblockUI);            return true;        }   });$(".gridRangeButton").click(function() {        var Index = parseInt($("#report tr:last").attr("title")) + 1;        addRow(Index);     });$(".gridRemoveButton").click(function() {    var Index = parseInt($("#report tr:last").attr("title"));    Index!=1?removeRow():'';    Index!=1?$('[name="rows"]').val(Index-1):''; });  function addRow(CurrIndex) {   	var new_hourfrom = 0,		new_hourto = 0;	//datefilter2 //time-input time ui-timepicker-input required	if(CurrIndex != 1)	{		var prev_hourto = ($('[row_hourto="'+(CurrIndex-1)+'"]').val() != '') ? parseInt($('[row_hourto="'+(CurrIndex-1)+'"]').val()) : 0,			next_hour =  (prev_hourto+2 < '10') ? '0'+(prev_hourto+2) : prev_hourto+2,			next_hour_2 =  (prev_hourto+2 < '10') ? '0'+(prev_hourto+3) : prev_hourto+3;						next_hour = (next_hour > 23) ? 23 : next_hour;			next_hour_2 = (next_hour_2 > 23) ? 23 : next_hour_2;		//var	min_next_hour_2 = (next_hour_2 > 20) ? 00 : next_hour_2;			}	     $("#report").append(            "<tr class='noteven' title='"+CurrIndex+"'>" +            "<td style='padding-top:5px'><input type='number' name='hourfrom[]'  min='"+next_hour+"' max='23' row_hourfrom='"+CurrIndex+"' class='datefilter2'  placeholder='0' value='"+(next_hour)+"'/></td>"+            "<td><input type='number' name='hourto[]'  min='"+next_hour_2+"' max='23' row_hourto='"+CurrIndex+"' class='datefilter2 required' placeholder='0' value='"+(next_hour_2)+"' /></td>"+                       "</tr>"         );			//$('[row_hourto="'+CurrIndex+'"]').val(next_hour);	//$('[row_hourfrom="'+CurrIndex+'"]').val(next_hour);	      $('[name="rows"]').val(CurrIndex);	  	  $(".datefilter2").timepicker({ timeFormat: 'HH',hourMin: prev_hourto+1});	  //since they lose their	  //$("#basicExample, .time-input").timepicker({'timeFormat': "H:i:s"}); }  function removeRow() {     $("#report tr:last").remove(); }  $('[name="penalty_type"]').change(function(){     var item = $('[name="penalty_type"]').val();     item == 'ABSOLUTE' || item=='PERCENTAGE' ? $("#range").hide():$("#range").show();     item == 'ABSOLUTE' || item=='PERCENTAGE' ? $(".gridRemoveButton").hide():$(".gridRemoveButton").show();     item == 'PERCENTAGE' ? $("#percentage").show() : $("#tarrif_ranges").hide();     if(item=='PERCENTAGE')         {             $("#percentage").show();             $("#tarrif_ranges").hide();         }     else         {             $("#percentage").hide();             $("#tarrif_ranges").show();         } });  $('[name="trx_type"]').change(function(){	 if($(this).val()=="Funds Allocation") { 		 $.ajax({			url: "inc/setvalue.php?transactiontype="+$(this).val(),			success: function(result) {				$('[name="available_funds"]').val(result);				$("#from_budget_label").hide();			}		});	} else if($(this).val()=="Funds Transfer") {		$('[name="available_funds"]').val("0.00");		$("#from_budget_label").show();		$('[name="budget_from"]').attr("class","required");	} else {		$('[name="available_funds"]').val("0.00");	} });   $('[name="budget_from"]').change(function() {	$('[name="budget_to"]').children('option').show();	 if($(this).val()!="Select Budget Line") { 		var sel_id = $(this).val();		 $.ajax({			url: "inc/setvalue.php?budgetline="+$(this).val(),			success: function(result) {				$('[name="available_funds"]').val(result);				$('[name="budget_to"]').children("option[value="+sel_id+"]").hide()			}		});	} else {		$('[name="available_funds"]').val("0.00");	} }); $(".gridConfirmButton").click(function() {    var deleteItem = confirm("Are you sure you want to Confirm the Agent?");    if (deleteItem)    {        var cell = $(this).closest('tr').attr('title'); //The Primary key for the row       //The Id representing the inner page        $('#ajaxcontent' + cell).hide();        $('#loading' + cell).show();        var form = $(this).closest("form");        var formname = "agents";         $.blockUI({ css: {             border: 'none',             padding: '15px',             backgroundColor: '#000',             '-webkit-border-radius': '10px',             '-moz-border-radius': '10px',             opacity: .5,             color: '#fff'         } });         $.ajax({            type: 'post',            url: 'forms/process_form.php?f=' + formname + '&action=confirm',            data: $("[name='" + formname + "']").serialize(),            success: function(result) {                //alert(result);            },            complete: function() {                location.reload();            }        });    }    return false;});$(".gridDeleteButton").click(function() {    var deleteItem = confirm("Are you sure you want to delete?");    if (deleteItem)    {        var cell = $(this).closest('tr').attr('title'); //The Primary key for the row        var page = $('#nextpage').val(); 				//The Id representing the inner page        $('#ajaxcontent' + cell).hide();        $('#loading' + cell).show();        var form = $(this).closest("form");        var formname = form.attr("name");         $.blockUI({ css: {             border: 'none',             padding: '15px',             backgroundColor: '#000',             '-webkit-border-radius': '10px',             '-moz-border-radius': '10px',             opacity: .5,             color: '#fff'         } });         $.ajax({            type: 'post',            url: '../../SuperFrame/Shared/app/process_form.php?f=' + formname + '&action=delete',            data: $("[name='" + formname + "']").serialize(),            success: function(result) {                //alert(result);            },            complete: function() {                location.reload();            }        });           }    return false;});$(".gridUnlockButton").click(function() {    var deleteItem = confirm("Are you sure you want to Unlock?");    if (deleteItem)    {        var cell = $(this).closest('tr').attr('title'); //The Primary key for the row        var page = $('#nextpage').val(); 				//The Id representing the inner page        $('#ajaxcontent' + cell).hide();        $('#loading' + cell).show();        var form = $(this).closest("form");        var formname = form.attr("name");         $.blockUI({ css: {             border: 'none',             padding: '15px',             backgroundColor: '#000',             '-webkit-border-radius': '10px',             '-moz-border-radius': '10px',             opacity: .5,             color: '#fff'         } });         $.ajax({            type: 'post',            url: 'forms/process_form.php?f=' + formname + '&action=unlock',            data: $("[name='" + formname + "']").serialize(),            success: function(result) {                //alert(result);            },            complete: function() {                location.reload();            }        });           }    return false;});function showdialog(url)			{                $(function(){	                 url = "//mohstaging.iridiuminteractive.co.ke/Payments.aspx?PaymentId=4&Expense_type=Transport/Fuel";                // show a spinner or something via css                var dialog = $('<div style="display:none" class="loading"></div>').appendTo('body');                // open the dialog                        dialog.dialog({                        width: 645,                        height: 196,                        title: "title",                        // add a close listener to prevent adding multiple divs to the document                        close: function(event, ui) {                                // remove div with all data and events                                location.reload();                                dialog.remove();                        },                        modal: true,					                        buttons:{ "Close": function()                        { location.reload();                        dialog.remove(); }},                        //	resizable: true,                        //position: ['center','center'],					                        });                // load remote content                dialog.load(                        url,                        {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object                        function (responseText, textStatus, XMLHttpRequest) {                                // remove the loading class                                dialog.removeClass('loading');                        }                );                });        }